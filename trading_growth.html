<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Trading Growth & Salary Planner</title>
<style>
  :root{
    --bg:#0f172a;        /* slate-900 */
    --panel:#111827;     /* gray-900 */
    --muted:#94a3b8;     /* slate-400 */
    --text:#e5e7eb;      /* gray-200 */
    --accent:#38bdf8;    /* sky-400 */
    --accent-2:#22c55e;  /* green-500 */
    --danger:#ef4444;    /* red-500 */
    --border:#1f2937;    /* gray-800 */
    --chip:#0b1222;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue",Arial;
    background: radial-gradient(1200px 600px at 50% -200px, #13233a 0%, var(--bg) 60%);
    color:var(--text);
  }
  .wrap{max-width:1000px;margin:0 auto;padding:20px 16px 40px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px;}
  .title{font-weight:800;letter-spacing:.3px;font-size:clamp(20px,4vw,28px);}
  .badge{font-size:12px;color:var(--accent);background:rgba(56,189,248,.1);border:1px solid rgba(56,189,248,.3);padding:6px 10px;border-radius:999px;white-space:nowrap;}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));border:1px solid var(--border);border-radius:14px;padding:14px 14px;box-shadow:0 1px 0 rgba(255,255,255,.04) inset,0 10px 40px rgba(0,0,0,.35);}
  .inputs{display:grid;gap:12px;grid-template-columns:1fr 1fr; margin-top:8px;}
  @media (max-width:720px){ .inputs{grid-template-columns:1fr} }
  label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
  .field{display:flex;align-items:center;gap:8px;background:#0b1020;border:1px solid var(--border);border-radius:10px;padding:10px 12px;}
  .field input{width:100%;font-size:16px;background:transparent;border:none;outline:none;color:var(--text);}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:flex-start}
  .btn{appearance:none;border:none;outline:none;cursor:pointer;padding:12px 16px;border-radius:10px;font-weight:700;letter-spacing:.2px;font-size:15px;background:linear-gradient(180deg, var(--accent), #1287b8);color:#001018;box-shadow:0 6px 20px rgba(56,189,248,.35),0 0 0 1px rgba(56,189,248,.3) inset;}
  .btn.secondary{ background:#1f2937; color:#d1d5db; box-shadow:none; border:1px solid var(--border) }
  .pill{font-size:12px;color:#9bd7ff;background:rgba(56,189,248,.08);border:1px solid rgba(56,189,248,.28);padding:6px 10px;border-radius:999px;}
  .assume{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .assume .chip{background:var(--chip);border:1px solid var(--border);color:var(--muted);padding:6px 10px;border-radius:999px;font-size:12px}
  .grid{display:grid;gap:12px;grid-template-columns:1fr;margin-top:14px;}
  .summary{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:10px;}
  @media (max-width:860px){ .summary{ grid-template-columns:1fr } }
  .metric{background:#0b1020;border:1px solid var(--border);border-radius:12px;padding:12px;}
  .metric .k{font-size:12px;color:var(--muted)}
  .metric .v{font-size:22px;font-weight:800;margin-top:2px}
  .metric.positive .v{color:var(--accent-2)}
  .metric.negative .v{color:var(--danger)}
  details{background:#0b1020;border:1px solid var(--border);border-radius:12px;overflow:hidden;}
  summary{list-style:none;cursor:pointer;padding:14px 16px;font-weight:700;display:flex;align-items:center;justify-content:space-between;}
  summary::-webkit-details-marker{display:none}
  .year-tag{font-size:12px;color:var(--muted)}
  .tbl-wrap{overflow:auto;border-top:1px solid var(--border)}
  table{width:100%;border-collapse:separate;border-spacing:0}
  th, td{padding:10px 12px;text-align:right;white-space:nowrap}
  th:first-child, td:first-child{text-align:left}
  thead th{position:sticky;top:0;background:#0c1324;z-index:1;font-size:12px;color:var(--muted);border-bottom:1px solid var(--border)}
  tbody tr:nth-child(odd){background:#0c13241a}
  tfoot td{font-weight:800;border-top:1px solid var(--border);background:#0c1324}
  .note{color:var(--muted);font-size:12px;margin-top:10px;line-height:1.5}
  .footer{margin-top:20px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;color:var(--muted);font-size:12px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">Trading Growth & Salary Planner</div>
      <div class="badge">Single trade/day • TP is configurable</div>
    </header>

    <div class="card">
      <form id="form">
        <div class="inputs">
          <div>
            <label for="initial">Initial contribution <span class="pill">required</span></label>
            <div class="field"><span>$</span><input id="initial" type="number" step="0.01" min="0" placeholder="e.g. 25000" required /></div>
          </div>

          <div>
            <label for="tp">Daily TP (%) <span class="pill">required</span></label>
            <div class="field"><input id="tp" type="number" step="0.001" min="-100" max="100" placeholder="0.5" required /></div>
          </div>

          <div>
            <label for="salary">Salary per year (after tax) <span class="pill">optional (default 0)</span></label>
            <div class="field"><span>$</span><input id="salary" type="number" step="0.01" min="0" placeholder="e.g. 18000" /></div>
          </div>

          <div>
            <label for="tax">Tax rate on yearly profit <span class="pill">optional (default 30%)</span></label>
            <div class="field"><input id="tax" type="number" step="0.01" min="0" max="100" placeholder="30" /></div>
          </div>

          <div>
            <label for="years">Years to compound <span class="pill">required</span></label>
            <div class="field"><input id="years" type="number" step="1" min="1" placeholder="e.g. 5" required /></div>
          </div>
        </div>

        <div class="assume" aria-hidden="true">
          <div class="chip">Assumes exactly 1 trade per trading day</div>
          <div class="chip">20 trading days per month</div>
          <div class="chip">240 trading days per year</div>
          <div class="chip">Taxes applied at year end only</div>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn" type="submit">Calculate</button>
          <button class="btn secondary" type="button" id="reset">Reset</button>
        </div>
      </form>
    </div>

    <div id="output" class="grid" style="display:none">
      <div class="card" id="topline"></div>
      <div id="yearBlocks" class="grid"></div>
      <div class="footer">
        <div>Note: Monthly figures are <strong>pre-tax</strong>. Taxes are calculated from the full year’s <em>profit</em> only (no tax on losses).</div>
        <div>All values in USD (2-decimal rounding).</div>
      </div>
    </div>

    <p class="note">
      Example check: Initial <code>25000</code>, <strong>TP</strong> <code>0.5</code>, Salary <code>18000</code>, Tax <code>30</code>, Years <code>1</code> → Final ≈ <strong>$47,428.57</strong>.
    </p>
  </div>

<script>
(() => {
  const fmt = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 2 });

  // Fixed assumptions
  const DAYS_PER_MONTH = 20;
  const DAYS_PER_YEAR  = 240;

  // Default field values (no URL params)
  const DEFAULTS = {
    tp: 0.5,  // %
    tax: 30,  // %
    salary: 0
  };

  // DOM helpers
  const $ = sel => document.querySelector(sel);
  const form = $('#form');
  const out  = $('#output');
  const yearBlocks = $('#yearBlocks');
  const topline = $('#topline');

  // Prefill defaults to make it quicker to try
  $('#tp').value  = DEFAULTS.tp;
  $('#tax').value = DEFAULTS.tax;

  // Events
  form.addEventListener('submit', (e) => { e.preventDefault(); simulate(); });
  $('#reset').addEventListener('click', () => {
    form.reset();
    // restore soft defaults
    $('#tp').value = DEFAULTS.tp;
    $('#tax').value = DEFAULTS.tax;
    out.style.display = 'none';
    yearBlocks.innerHTML = '';
    topline.innerHTML = '';
  });

  function simulate(){
    const initial = toNum($('#initial').value);
    const tpPct   = toNum($('#tp').value, DEFAULTS.tp);
    const salary  = clampMin(toNum($('#salary').value, DEFAULTS.salary), 0);
    const taxPct  = clamp(toNum($('#tax').value, DEFAULTS.tax), 0, 100);
    const years   = Math.max(1, Math.floor(toNum($('#years').value)));

    if (!isFinite(initial) || initial <= 0) { alert('Please enter a valid Initial contribution (> 0).'); return; }
    if (!isFinite(tpPct)) { alert('Please enter a valid Daily TP (%).'); return; }
    if (!Number.isInteger(years) || years < 1) { alert('Years must be a whole number ≥ 1.'); return; }

    // Factors
    const dailyFactor   = 1 + (tpPct / 100);
    const monthlyFactor = Math.pow(dailyFactor, DAYS_PER_MONTH);
    const yearlyFactor  = Math.pow(dailyFactor, DAYS_PER_YEAR);

    // Run simulation
    const results = [];
    let capital = initial;

    for (let y = 1; y <= years; y++) {
      const start = capital;

      // Monthly (pre-tax) breakdown vs Year Start
      const months = [];
      for (let m = 1; m <= 12; m++) {
        const endBal = start * Math.pow(monthlyFactor, m);
        const profitVsStart = endBal - start;
        months.push({ month: m, endBalance: endBal, profitVsStart });
      }

      // Year summary
      const grossEnd = start * yearlyFactor;
      const profitBeforeTax = grossEnd - start;
      const taxes = profitBeforeTax > 0 ? profitBeforeTax * (taxPct / 100) : 0; // tax only on profits
      const afterTaxProfit = profitBeforeTax - taxes;
      const postTaxBeforeSalary = start + afterTaxProfit;
      const endAfterSalary = postTaxBeforeSalary - salary;

      results.push({
        year: y,
        start,
        grossEnd,
        profitBeforeTax,
        taxes,
        afterTaxProfit,
        postTaxBeforeSalary,
        salaryPaid: salary,
        endAfterSalary,
        months
      });

      capital = endAfterSalary;
      if (capital <= 0) break; // stop if depleted
    }

    renderTopline(initial, tpPct, salary, taxPct, results, monthlyFactor, yearlyFactor);
    renderYears(results, taxPct);
    out.style.display = '';
  }

  function renderTopline(initial, tpPct, salary, taxPct, results, monthlyFactor, yearlyFactor){
    const last = results[results.length - 1] || { endAfterSalary: initial };
    const monthlyPreview = initial * monthlyFactor;
    const yearlyPreview = initial * yearlyFactor;
    const finalCarry = last.endAfterSalary;
    const totalTaxes = sum(results.map(r => r.taxes));
    const totalSalary = sum(results.map(r => r.salaryPaid));
    const danger = finalCarry < 0;

    topline.innerHTML = `
      <div class="row" style="justify-content:space-between; gap:8px; flex-wrap:wrap">
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <div class="pill">TP/day: ${(+tpPct).toFixed(3).replace(/\.?0+$/,'')}%</div>
          <div class="pill">20 trading days / month</div>
          <div class="pill">240 trading days / year</div>
        </div>
        <div class="year-tag">Horizon: <strong>${results.length}</strong> ${results.length===1?'year':'years'}</div>
      </div>

      <div class="summary">
        <div class="metric">
          <div class="k">1-Month Preview (pre-tax)</div>
          <div class="v">${fmt.format(monthlyPreview)}</div>
          <div class="k" style="margin-top:4px">Profit vs start: ${fmt.format(monthlyPreview - initial)}</div>
        </div>

        <div class="metric">
          <div class="k">1-Year Preview (pre-tax)</div>
          <div class="v">${fmt.format(yearlyPreview)}</div>
          <div class="k" style="margin-top:4px">Profit vs start: ${fmt.format(yearlyPreview - initial)}</div>
        </div>

        <div class="metric ${danger ? 'negative':'positive'}">
          <div class="k">Final Balance after taxes & salary</div>
          <div class="v">${fmt.format(finalCarry)}</div>
          <div class="k" style="margin-top:4px">Total taxes over horizon: ${fmt.format(totalTaxes)} • Total salary paid: ${fmt.format(totalSalary)}</div>
        </div>
      </div>
    `;
  }

  function renderYears(results, taxPct){
    const fmtPct = (x)=> (x*100).toFixed(2) + '%';
    yearBlocks.innerHTML = '';
    results.forEach((r, idx) => {
      const yrTitle = `Year ${r.year}`;
      const open = idx === 0 ? ' open' : '';
      const yld = r.start === 0 ? 0 : r.profitBeforeTax / r.start;

      const yearHTML = `
        <details${open}>
          <summary>
            <span>
              ${yrTitle}
              <span class="year-tag"> • Start: ${fmt.format(r.start)} • End (after salary): <strong>${fmt.format(r.endAfterSalary)}</strong></span>
            </span>
            <span class="year-tag">${fmtPct(yld)} gross return</span>
          </summary>

          <div class="tbl-wrap">
            <table>
              <thead>
                <tr>
                  <th>Month</th>
                  <th>End Balance (pre-tax)</th>
                  <th>Profit vs Year Start</th>
                </tr>
              </thead>
              <tbody>
                ${r.months.map(m => `
                  <tr>
                    <td>Month ${m.month}</td>
                    <td>${fmt.format(m.endBalance)}</td>
                    <td>${fmt.format(m.profitVsStart)}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>

          <div class="tbl-wrap">
            <table>
              <thead>
                <tr>
                  <th>Year Start</th>
                  <th>Year End (pre-tax)</th>
                  <th>Profit (pre-tax)</th>
                  <th>Taxes (${(+taxPct).toFixed(2)}%)</th>
                  <th>Post-Tax Balance (before salary)</th>
                  <th>Salary Paid</th>
                  <th>Year End (carryover)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${fmt.format(r.start)}</td>
                  <td>${fmt.format(r.grossEnd)}</td>
                  <td>${fmt.format(r.profitBeforeTax)}</td>
                  <td>${fmt.format(r.taxes)}</td>
                  <td>${fmt.format(r.postTaxBeforeSalary)}</td>
                  <td>${fmt.format(r.salaryPaid)}</td>
                  <td><strong>${fmt.format(r.endAfterSalary)}</strong></td>
                </tr>
              </tbody>
            </table>
          </div>
        </details>
      `;

      const container = document.createElement('div');
      container.className = 'card';
      container.innerHTML = yearHTML;
      yearBlocks.appendChild(container);
    });
  }

  // Utils
  function toNum(v, d=NaN){ const n = parseFloat(String(v||'').trim()); return isNaN(n)?d:n; }
  function clamp(n, a, b){ return Math.min(Math.max(n, a), b); }
  function clampMin(n, a){ return Math.max(n, a); }
  function sum(arr){ return arr.reduce((s,x)=>s+(+x||0),0); }
})();
</script>
</body>
</html>