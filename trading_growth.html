<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Trading Growth & Salary Planner</title>
<style>
  :root{
    --bg:#0c0f14;
    --panel:#121722;
    --panel-2:#171d2a;
    --ink:#e6edf3;
    --muted:#9fb0c3;
    --accent:#4cc9f0;
    --good:#22c55e;
    --warn:#f59e0b;
    --bad:#ef4444;
    --grid:#1f2937;
    --chip:#0b2431;
    --shadow:0 10px 30px rgba(0,0,0,.4), 0 0 0 1px rgba(76,201,240,.04) inset;
    --radius:14px;
  }
  html,body{background:var(--bg); color:var(--ink); font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji"; margin:0;}
  .wrap{max-width:1100px; margin:0 auto; padding:18px;}
  header{
    border-radius:var(--radius);
    padding:20px 18px;
    background:linear-gradient(180deg, #0f1420 0%, #0b0f17 100%);
    position:relative; overflow:hidden;
    box-shadow:var(--shadow);
  }
  header .brand{display:flex; gap:12px; align-items:center;}
  .logo{
    width:36px;height:36px;border-radius:8px;
    background: radial-gradient(100% 100% at 50% 0%, #2dd4bf 0%, #3b82f6 60%, #8b5cf6 100%);
    box-shadow:0 8px 28px rgba(59,130,246,.35);
  }
  h1{font-size:20px; margin:0;}
  p.sub{margin:6px 0 0 0; color:var(--muted); font-size:13px;}
  .panel{
    background:var(--panel);
    border-radius:var(--radius);
    padding:14px;
    box-shadow:var(--shadow);
  }
  .grid{
    display:grid; gap:10px;
    grid-template-columns: repeat(12, 1fr);
  }
  .grid .panel{grid-column: span 12;}
  @media (min-width:760px){
    .grid .inputs{grid-column: span 12;}
    .grid .summary{grid-column: span 12;}
    .grid .tablewrap{grid-column: span 12;}
  }
  .inputs form{display:grid; gap:10px; grid-template-columns:repeat(12,1fr);}
  .inputs .field{grid-column: span 12;}
  @media (min-width:680px){
    .inputs .field.sm-6{grid-column: span 6;}
    .inputs .field.sm-4{grid-column: span 4;}
    .inputs .field.sm-3{grid-column: span 3;}
  }
  label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px;}
  input, select{
    width:100%; box-sizing:border-box; border-radius:10px; border:1px solid #263041;
    padding:12px 12px; background:var(--panel-2); color:var(--ink); font-size:14px; outline:none;
  }
  input:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(76,201,240,.12);}
  .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:4px;}
  button{
    background:var(--accent); color:#001018; border:none; border-radius:10px; padding:12px 14px; font-weight:700; cursor:pointer;
  }
  button.secondary{background:#223043; color:var(--ink);}
  .hint{font-size:12px; color:var(--muted); margin-top:4px;}
  .summary .cards{display:grid; gap:10px; grid-template-columns:repeat(12,1fr);}
  .card{grid-column: span 12; background:var(--panel-2); border-radius:12px; padding:12px; border:1px solid #1d2635;}
  @media (min-width:680px){
    .card{grid-column: span 4;}
  }
  .k{font-size:12px; color:var(--muted);}
  .v{font-size:20px; font-weight:800; margin-top:4px;}
  .good{color:var(--good)}
  .bad{color:var(--bad)}
  .tablewrap{padding:0;}
  .tablewrap .toprow{display:flex; justify-content:space-between; gap:10px; align-items:end; margin-bottom:8px; flex-wrap:wrap;}
  .tablewrap .toprow .chips{display:flex; gap:6px; flex-wrap:wrap;}
  .chip{
    background:var(--chip); color:#a8e9ff; border:1px solid #1c3441;
    padding:6px 8px; border-radius:999px; font-size:12px;
  }
  .table-box{overflow:auto; border:1px solid #1d2635; border-radius:12px;}
  table{width:100%; border-collapse:separate; border-spacing:0; min-width:840px; background:var(--panel-2);}
  thead th{
    position:sticky; top:0; background:#101626; z-index:5;
    text-align:left; font-size:12px; color:#c9d6e3; padding:10px; border-bottom:1px solid #233149;
  }
  tbody td{padding:10px; border-bottom:1px solid #1f2a3e; font-size:13px;}
  tbody tr.year-header td{
    background:#0f1524; color:#b8cff1; font-weight:800; border-bottom:1px solid #22314b;
  }
  tbody tr.total-row{background:#0e1625;}
  tbody tr.total-row td{border-top:1px dashed #2a3a57;}
  .right{text-align:right;}
  .muted{color:var(--muted);}
  details{
    background:var(--panel-2);
    border:1px solid #1d2635;
    border-radius:12px; padding:12px; margin-top:10px;
  }
  details > summary{cursor:pointer; font-weight:700}
  .foot{color:var(--muted); font-size:12px; margin-top:8px;}
  .warn{color:var(--warn);}
</style>
</head>
<body>
  <div class="wrap">
    <header class="panel">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Trading Growth & Salary Planner</h1>
          <p class="sub">Compounds daily take-profit, taxes once per year, then pays you a fixed salary. Monthly breakdowns are pre-tax; yearly rows show taxes & salary.</p>
        </div>
      </div>
    </header>

    <div class="grid" style="margin-top:12px">
      <section class="panel inputs">
        <form id="form">
          <div class="field sm-4">
            <label for="initial">Initial contribution (USD) *</label>
            <input id="initial" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 25000" required>
          </div>
          <div class="field sm-3">
            <label for="tp">Daily TP % *</label>
            <input id="tp" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 0.5" required>
          </div>
          <div class="field sm-3">
            <label for="years">Years to compound *</label>
            <input id="years" type="number" inputmode="numeric" min="1" step="1" placeholder="e.g., 1" required>
          </div>
          <div class="field sm-3">
            <label for="days">Trading days each year *</label>
            <input id="days" type="number" inputmode="numeric" min="1" step="1" placeholder="Default 240" value="240" required>
            <div class="hint">Monthly breakdown allocates these days across 12 months.</div>
          </div>
          <div class="field sm-3">
            <label for="tax">Taxes on profits at year end % (optional)</label>
            <input id="tax" type="number" inputmode="decimal" min="0" max="100" step="0.1" placeholder="Default 30" value="30">
          </div>
          <div class="field sm-3">
            <label for="salary">Salary paid after taxes each year (USD, optional)</label>
            <input id="salary" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Default 0" value="0">
          </div>

          <div class="field sm-12">
            <div class="actions">
              <button type="button" id="calcBtn">Calculate</button>
              <button type="button" class="secondary" id="exampleBtn">Try the example</button>
              <button type="reset" class="secondary" id="resetBtn">Reset</button>
            </div>
            <div class="hint">Note: we compute using full precision and round only for display. Tiny 1-cent differences from hand-rounded examples can occur.</div>
          </div>
        </form>
      </section>

      <section class="panel summary">
        <div class="cards" id="summaryCards">
          <div class="card">
            <div class="k">Final balance</div>
            <div class="v" id="finalBalance">$0.00</div>
            <div class="foot" id="finalFoot">After salaries & taxes across all years.</div>
          </div>
          <div class="card">
            <div class="k">Total taxes paid</div>
            <div class="v" id="totalTaxes">$0.00</div>
            <div class="foot">Only applied to positive yearly profits.</div>
          </div>
          <div class="card">
            <div class="k">Total salary paid</div>
            <div class="v" id="totalSalary">$0.00</div>
            <div class="foot" id="salaryWarn"></div>
          </div>
        </div>
      </section>

      <section class="panel tablewrap">
        <div class="toprow">
          <div class="chips" id="chips"></div>
          <div class="hint">Monthly rows are <span class="muted">pre-tax</span>. The yearly total row shows <span class="muted">taxes</span> and your <span class="muted">salary</span> deducted.</div>
        </div>
        <div class="table-box">
          <table id="resultTable" aria-describedby="tableDesc">
            <thead>
              <tr>
                <th>Year</th>
                <th>Period</th>
                <th class="right">Days</th>
                <th class="right">Year Start</th>
                <th class="right">Period End</th>
                <th class="right">Profit vs Year Start</th>
                <th class="right">Taxes</th>
                <th class="right">Salary</th>
              </tr>
            </thead>
            <tbody id="tbody">
              <!-- rows injected -->
            </tbody>
          </table>
        </div>
        <p id="tableDesc" class="foot">“Profit vs Year Start” is before tax on monthly rows; on yearly rows it is after tax (i.e., net profit for that year before salary).</p>

        <details>
          <summary>How the math works</summary>
          <div class="foot" style="margin-top:8px">
            <ol>
              <li><b>Daily compounding:</b> If your daily TP is <i>r%</i> and a year has <i>D</i> trading days, the pre-tax end-of-year balance is <code>Start × (1 + r/100)<sup>D</sup></code>.</li>
              <li><b>Yearly profit:</b> <code>GrossProfit = EndPreTax − Start</code>.</li>
              <li><b>Taxes at year end:</b> <code>Taxes = max(0, GrossProfit × tax%)</code>. (No tax on losses.)</li>
              <li><b>After-tax profit:</b> <code>NetProfit = GrossProfit − Taxes</code>.</li>
              <li><b>Pay yourself:</b> <code>YearEnd = Start + NetProfit − Salary</code>. This result becomes next year’s starting balance.</li>
              <li><b>Monthly breakdown:</b> We split the year’s trading days across 12 months and compound sequentially. Monthly rows are always pre-tax.</li>
            </ol>
            <p class="foot">Example you gave: Start 25,000; r=0.5%; D=240; Tax 30%; Salary 18,000 ⇒ Pre-tax end ≈ 82,755.11; Gross profit ≈ 57,755.11; Net profit ≈ 40,428.58; Final after salary ≈ <b>$47,428.58</b>. (A 1-cent difference vs hand-rounded steps is normal.)</p>
          </div>
        </details>
      </section>
    </div>
  </div>

<script>
(function(){
  const $ = (sel)=>document.querySelector(sel);
  const fmtUSD = (n)=>new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',minimumFractionDigits:2,maximumFractionDigits:2}).format(n||0);
  const fmtPct = (n)=>`${Number(n).toFixed(2)}%`;
  const monthNames = ["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"];

  const els = {
    initial: $('#initial'),
    tp: $('#tp'),
    years: $('#years'),
    days: $('#days'),
    tax: $('#tax'),
    salary: $('#salary'),
    calcBtn: $('#calcBtn'),
    exampleBtn: $('#exampleBtn'),
    resetBtn: $('#resetBtn'),
    tbody: $('#tbody'),
    chips: $('#chips'),
    finalBalance: $('#finalBalance'),
    totalTaxes: $('#totalTaxes'),
    totalSalary: $('#totalSalary'),
    finalFoot: $('#finalFoot'),
    salaryWarn: $('#salaryWarn'),
  };

  // Smart distribution of trading days across 12 months (sums exactly to D)
  function splitDaysAcrossMonths(totalDays){
    const base = Math.floor(totalDays / 12);
    let remainder = totalDays - base*12;
    const arr = new Array(12).fill(base);
    // distribute the remainder one per month starting from the early months
    for(let i=0;i<remainder;i++){ arr[i] += 1; }
    return arr;
  }

  function calcPlan({initial, tpPct, years, daysPerYear, taxPct, salary}){
    const tp = tpPct/100; // daily rate (decimal)
    const tax = taxPct/100;
    let balance = initial;
    let totalTaxes = 0;
    let totalSalary = 0;
    const rows = [];
    const chips = [];

    for(let y=1; y<=years; y++){
      const yearStart = balance;
      const monthDays = splitDaysAcrossMonths(daysPerYear);
      // monthly, pre-tax
      for(let m=0;m<12;m++){
        const days = monthDays[m];
        const end = balance * Math.pow(1+tp, days);
        const profitVsStart = end - yearStart;
        rows.push({
          type:'month', year:y, period:monthNames[m],
          days, yearStart, end, profitVsStart,
          taxes: 0, salary: 0
        });
        balance = end; // roll forward
      }
      // end of year adjustments
      const endPreTax = balance;
      const grossProfit = endPreTax - yearStart;
      const taxes = Math.max(0, grossProfit * tax);
      const netProfit = grossProfit - taxes;
      const endAfterTax = yearStart + netProfit;
      const endAfterSalary = endAfterTax - salary;

      totalTaxes += taxes;
      totalSalary += salary;

      rows.push({
        type:'year', year:y, period:'Year Total',
        days: daysPerYear, yearStart,
        end: endAfterSalary, // final for the year (after tax & salary)
        profitVsStart: netProfit, // after-tax profit for the year
        taxes, salary
      });

      // Next year starts from end-of-year balance (can go negative if salary > funds)
      balance = endAfterSalary;
      // year chip
      chips.push({
        y,
        start: yearStart,
        end: endAfterSalary,
        days: daysPerYear
      });
    }

    return {rows, finalBalance: balance, totalTaxes, totalSalary, chips};
  }

  function render({rows, finalBalance, totalTaxes, totalSalary, chips}){
    // Summary cards
    els.finalBalance.textContent = fmtUSD(finalBalance);
    els.totalTaxes.textContent = fmtUSD(totalTaxes);
    els.totalSalary.textContent = fmtUSD(totalSalary);
    els.finalFoot.textContent = `After ${chips.length} year${chips.length>1?'s':''} of compounding.`;
    els.salaryWarn.textContent = '';

    if(finalBalance < 0){
      els.finalBalance.classList.add('bad');
      els.finalFoot.textContent += ' Balance is negative because salary exceeded funds.';
    } else {
      els.finalBalance.classList.remove('bad');
    }

    // Chips
    els.chips.innerHTML = chips.map(c=>(
      `<span class="chip">Y${c.y}: ${fmtUSD(c.start)} → ${fmtUSD(c.end)} · ${c.days}d</span>`
    )).join('');

    // Table rows
    const html = [];
    let lastYear = 0;
    rows.forEach(r=>{
      if(r.year !== lastYear){
        html.push(`<tr class="year-header"><td colspan="8">Year ${r.year} — Start ${fmtUSD(r.yearStart)}</td></tr>`);
        lastYear = r.year;
      }
      const isYear = r.type==='year';
      html.push(`
        <tr class="${isYear?'total-row':''}">
          <td>${r.year}</td>
          <td>${r.period}</td>
          <td class="right">${r.days}</td>
          <td class="right">${fmtUSD(r.yearStart)}</td>
          <td class="right">${fmtUSD(r.end)}</td>
          <td class="right ${isYear ? 'good' : ''}">${fmtUSD(r.profitVsStart)}</td>
          <td class="right">${isYear?fmtUSD(r.taxes):'—'}</td>
          <td class="right">${isYear?fmtUSD(r.salary):'—'}</td>
        </tr>
      `);
    });
    els.tbody.innerHTML = html.join('');
  }

  function getInputs(){
    const initial = Number(els.initial.value);
    const tpPct = Number(els.tp.value);
    const years = Number(els.years.value);
    const daysPerYear = Number(els.days.value || 240);
    const taxPct = els.tax.value==='' ? 30 : Number(els.tax.value);
    const salary = els.salary.value==='' ? 0 : Number(els.salary.value);

    const errors = [];
    if(!(initial > 0)) errors.push('Initial contribution must be greater than 0.');
    if(!(tpPct >= 0)) errors.push('Daily TP % must be 0 or more.');
    if(!(years >= 1 && Number.isInteger(years))) errors.push('Years must be a whole number ≥ 1.');
    if(!(daysPerYear >= 1 && Number.isInteger(daysPerYear))) errors.push('Trading days per year must be a whole number ≥ 1.');
    if(!(taxPct >= 0 && taxPct <= 100)) errors.push('Taxes must be between 0 and 100%.');
    if(!(salary >= 0)) errors.push('Salary can’t be negative.');

    return {initial, tpPct, years, daysPerYear, taxPct, salary, errors};
  }

  function calculateAndRender(){
    const {initial, tpPct, years, daysPerYear, taxPct, salary, errors} = getInputs();
    if(errors.length){
      alert(errors.join('\n'));
      return;
    }
    const result = calcPlan({initial, tpPct, years, daysPerYear, taxPct, salary});
    render(result);
  }

  // Prefill with a clean slate
  function setDefaults(){
    els.initial.value = '';
    els.tp.value = '';
    els.years.value = '';
    els.days.value = 240;
    els.tax.value = 30;
    els.salary.value = 0;
    // Clear outputs
    render({rows:[], finalBalance:0, totalTaxes:0, totalSalary:0, chips:[]});
    els.chips.innerHTML = '';
  }

  // Example from your prompt
  function loadExample(){
    els.initial.value = 25000;
    els.tp.value = 0.5;
    els.years.value = 1;
    els.days.value = 240;
    els.tax.value = 30;
    els.salary.value = 18000;
    calculateAndRender();
  }

  // Wire up
  els.calcBtn.addEventListener('click', calculateAndRender);
  els.exampleBtn.addEventListener('click', loadExample);
  els.resetBtn.addEventListener('click', setDefaults);

  // Auto-calc on input changes (debounced)
  let t;
  document.querySelectorAll('#form input').forEach(inp=>{
    inp.addEventListener('input', ()=>{
      clearTimeout(t);
      t = setTimeout(()=>{ // gentle debounce for mobile typing
        if(els.initial.value && els.tp.value && els.years.value){
          calculateAndRender();
        }
      }, 220);
    });
  });

  // First render (blank)
  setDefaults();
})();
</script>
</body>
</html>